throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
if(length(unique(throw_in_scene$teamId)) == 1){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
View(throw_ins_sub_poss)
kept_possession <- throw_ins_sub_poss %>%
group_by(season, league)
summarize(kept_possession = mean(kept_possession))
kept_possession <- throw_ins_sub_poss %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(kept_possession)
blogdown:::serve_site()
team_id <- 26
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_ins <- tbl(con, "events") %>%
filter(teamId == team_id) %>%
filter(type_name == "Pass") %>%
filter(qualifiers %like% "%ThrowIn%") %>%
collect()
library(tidyverse)
library(dbplyr)
library(DBI)
team_id <- 26
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
matches <- tbl(con, "matches") %>%
filter(home_team_id == team_id | away_team_id == team_id) %>%
select(c("match_id", "season", "league", "date")) %>%
collect()
DBI::dbDisconnect(con)
match_summary <- matches %>%
group_by(season, league) %>%
summarise(count = n())
team_id <- 26
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_ins <- tbl(con, "events") %>%
filter(teamId == team_id) %>%
filter(type_name == "Pass") %>%
filter(qualifiers %like% "%ThrowIn%") %>%
collect()
DBI::dbDisconnect(con)
how_many_seconds <- 5
#throw_ins_sub <- head(throw_ins, 100)
throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(events_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
if(length(unique(throw_in_scene$teamId)) == 1){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
how_many_seconds <- 5
#throw_ins_sub <- head(throw_ins, 100)
throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
if(length(unique(throw_in_scene$teamId)) == 1){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
kept_possession <- throw_ins_sub_poss %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(kept_possession)
View(throw_ins_sub_poss)
throw_ins_sub_poss_t <- throw_ins_sub_poss %>%
mutate(quintile = ceiling(location_x/20))
kept_possession <- throw_ins_sub_poss_t %>%
group_by(season, league, quintile) %>%
summarize(kept_possession = mean(kept_possession))
View(kept_possession)
View(kept_possession)
team_id <- 26
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
matches <- tbl(con, "matches") %>%
filter(season %in% c("2019/2020", "2018/2019", "2017/2018")) %>%
filter(home_team_id == team_id | away_team_id == team_id) %>%
select(c("match_id", "season", "league", "date")) %>%
collect()
DBI::dbDisconnect(con)
match_summary <- matches %>%
group_by(season, league) %>%
summarise(count = n())
View(matches)
match_ids <- matches$match_id
team_id <- 26
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_ins <- tbl(con, "events") %>%
filter(match_id %in% match_ids) %>%
filter(teamId == team_id) %>%
filter(type_name == "Pass") %>%
filter(qualifiers %like% "%ThrowIn%") %>%
collect()
DBI::dbDisconnect(con)
View(throw_in_scene)
how_many_seconds <- 5
throw_ins_sub <- head(throw_ins, 10)
#throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
if(length(unique(throw_in_scene$teamId)) == 1){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
throw_ins_sub_poss_t <- throw_ins_sub_poss %>%
mutate(quintile = ceiling(location_x/20))
View(throw_in_scene)
how_many_seconds <- 5
throw_ins_sub <- head(throw_ins, 9)
#throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
if(length(unique(throw_in_scene$teamId)) == 1){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
View(throw_in_scene)
how_many_seconds <- 5
throw_ins_sub <- head(throw_ins, 8)
#throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
if(length(unique(throw_in_scene$teamId)) == 1){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
View(throw_in_scene)
View(events)
how_many_seconds <- 5
throw_ins_sub <- head(throw_ins, 8)
#throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
#if(length(unique(throw_in_scene$teamId)) == 1){
if(throw_in_scene$teamId[nrow(throw_in_scene),] == team_id){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
how_many_seconds <- 5
throw_ins_sub <- head(throw_ins, 8)
#throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
#if(length(unique(throw_in_scene$teamId)) == 1){
if(throw_in_scene[nrow(throw_in_scene),]$teamId == team_id){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
View(throw_ins_sub_poss)
View(throw_in_scene)
how_many_seconds <- 5
throw_ins_sub <- head(throw_ins, 9)
#throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
#if(length(unique(throw_in_scene$teamId)) == 1){
if(throw_in_scene[nrow(throw_in_scene),]$teamId == team_id){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
View(throw_in_scene)
View(throw_ins_sub_poss)
how_many_seconds <- 5
throw_ins_sub <- head(throw_ins, 9)
#throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
#if(length(unique(throw_in_scene$teamId)) == 1){
if(throw_in_scene[nrow(throw_in_scene),]$teamId == team_id | any(throw_in_scene$isShot)){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
how_many_seconds <- 5
throw_ins_sub <- head(throw_ins, 9)
#throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
#if(length(unique(throw_in_scene$teamId)) == 1){
if(throw_in_scene[nrow(throw_in_scene),]$teamId == team_id | 1 %in% throw_in_scene$isShot){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
View(throw_ins_sub_poss)
how_many_seconds <- 5
#throw_ins_sub <- head(throw_ins, 9)
throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
start_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
end_time <- start_time + how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
#if(length(unique(throw_in_scene$teamId)) == 1){
if(throw_in_scene[nrow(throw_in_scene),]$teamId == team_id | 1 %in% throw_in_scene$isShot){
throw_in_row$kept_possession <- 1
} else {
throw_in_row$kept_possession <- 0
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_poss <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_poss <- left_join(throw_ins_sub_poss, matches, by = c("match_id"))
kept_possession <- throw_ins_sub_poss %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(kept_possession)
throw_ins_sub_poss_q <- throw_ins_sub_poss %>%
mutate(quintile = ceiling(location_x/20))
kept_possession <- throw_ins_sub_poss_q %>%
group_by(season, league, quintile) %>%
summarize(kept_possession = mean(kept_possession))
View(kept_possession)
throw_ins_sub_poss_q <- throw_ins_sub_poss %>%
mutate(quintile = ceiling(location_x/20))
kept_possession <- throw_ins_sub_poss_q %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(kept_possession)
View(events_sub)
how_many_seconds <- 60
#events_sub <- head(events, 100)
throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
end_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
start_time <- end_time - how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
row_in_scene <- nrow(throw_in_scene)
throw_in_row$time_to_throw_in <- (throw_in_scene$minute[[row_in_scene]]*60 + throw_in_scene$second[[row_in_scene]]) -
(throw_in_scene$minute[[row_in_scene-1]]*60 + throw_in_scene$second[[row_in_scene-1]])
df_to_concat[[i]] <- throw_in_row
}
how_many_seconds <- 60
#events_sub <- head(events, 100)
throw_ins_sub <- throw_ins
df_to_concat <- list()
for(i in 1:nrow(throw_ins_sub))
{
match_id_filter <- throw_ins_sub$match_id[[i]]
end_time <- throw_ins_sub$minute[[i]]*60 + throw_ins_sub$second[[i]]
start_time <- end_time - how_many_seconds
con <- DBI::dbConnect(RSQLite::SQLite(), dbname = "~/Documents/Blog/Data/data.sqlite")
throw_in_scene <- tbl(con, "events") %>%
filter(match_id == match_id_filter) %>%
filter(between(minute*60 + second, start_time, end_time)) %>%
collect()
DBI::dbDisconnect(con)
throw_in_row <- slice(throw_ins_sub, i)
row_in_scene <- nrow(throw_in_scene)
if(row_in_scene >= 2){
throw_in_row$time_to_throw_in <- (throw_in_scene$minute[[row_in_scene]]*60 + throw_in_scene$second[[row_in_scene]]) -
(throw_in_scene$minute[[row_in_scene-1]]*60 + throw_in_scene$second[[row_in_scene-1]])
} else{
throw_in_row$time_to_throw_in <- 60
}
df_to_concat[[i]] <- throw_in_row
}
throw_ins_sub_time <- purrr::reduce(df_to_concat, rbind)
throw_ins_sub_time_q <- throw_ins_sub_time %>%
mutate(quintile = ceiling(location_x/20))
kept_possession <- throw_ins_sub_time_q %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
throw_ins_sub_time <- left_join(throw_ins_sub_time, matches, by = c("match_id"))
throw_ins_sub_time_q <- throw_ins_sub_time %>%
mutate(quintile = ceiling(location_x/20))
kept_possession <- throw_ins_sub_time_q %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(kept_possession)
View(throw_ins_sub_time)
throw_ins_sub_time_q <- throw_ins_sub_time %>%
mutate(quintile = ceiling(location_x/20))
time_to_throw <- throw_ins_sub_time_q %>%
group_by(season, league) %>%
summarize(time_to_throw_in = mean(time_to_throw_in))
View(time_to_throw)
View(throw_ins_sub_poss)
test <- left_join(throw_ins_sub_time, throw_ins_sub_poss, matches, by = c("event_id"))
test <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id"))
merged_throw_in <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id"))
merged_throw_in <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id"))
merged_throw_in <- merged_throw_in %>%
filter(time_to_throw_in > 15) %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(merged_throw_in)
merged_throw_in <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id"))
merged_throw_in <- merged_throw_in %>%
filter(time_to_throw_in < 10) %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(merged_throw_in)
merged_throw_in <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id"))
merged_throw_in <- merged_throw_in %>%
filter(time_to_throw_in < 5) %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(merged_throw_in)
merged_throw_in <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id"))
merged_throw_in <- merged_throw_in %>%
filter(time_to_throw_in < 10) %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(merged_throw_in)
merged_throw_in <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id"))
merged_throw_in <- merged_throw_in %>%
filter(time_to_throw_in >10) %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(merged_throw_in)
merged_throw_in <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id"))
merged_throw_in <- merged_throw_in %>%
filter(time_to_throw_in <10) %>%
group_by(season, league) %>%
summarize(kept_possession = mean(kept_possession))
View(merged_throw_in)
merged_throw_in <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id")) %>%
mutate(quintile = ceiling(location_x/20))
merged_throw_in <- merged_throw_in %>%
filter(time_to_throw_in < 10) %>%
group_by(season, league, quintile) %>%
summarize(kept_possession = mean(kept_possession))
merged_throw_in <- left_join(throw_ins_sub_time, select(throw_ins_sub_poss, c("event_id", "kept_possession")), matches, by = c("event_id")) %>%
mutate(quintile = ceiling(location_x/20))
merged_throw_in <- merged_throw_in %>%
filter(time_to_throw_in > 15) %>%
group_by(season, league, quintile) %>%
summarize(kept_possession = mean(kept_possession))
View(kept_possession)
View(merged_throw_in)
